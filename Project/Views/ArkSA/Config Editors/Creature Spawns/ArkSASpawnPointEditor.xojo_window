#tag DesktopWindow
Begin BeaconContainer ArkSASpawnPointEditor
   AllowAutoDeactivate=   True
   AllowFocus      =   False
   AllowFocusRing  =   False
   AllowTabs       =   True
   Backdrop        =   0
   BackgroundColor =   &cFFFFFF00
   Composited      =   False
   DoubleBuffer    =   "False"
   Enabled         =   True
   EraseBackground =   "True"
   HasBackgroundColor=   False
   Height          =   664
   Index           =   -2147483648
   InitialParent   =   ""
   Left            =   0
   LockBottom      =   True
   LockLeft        =   True
   LockRight       =   True
   LockTop         =   True
   TabIndex        =   0
   TabPanelIndex   =   0
   TabStop         =   True
   Tooltip         =   ""
   Top             =   0
   Transparent     =   False
   Visible         =   True
   Width           =   906
   Begin FadedSeparator ColumnSeparator
      AllowAutoDeactivate=   True
      AllowFocus      =   False
      AllowFocusRing  =   True
      AllowTabs       =   False
      Backdrop        =   0
      ContentHeight   =   0
      Enabled         =   True
      Height          =   664
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   200
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      ScrollActive    =   False
      ScrollingEnabled=   False
      ScrollSpeed     =   20
      TabIndex        =   1
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   0
      Transparent     =   True
      Visible         =   True
      Width           =   1
   End
   Begin DesktopPagePanel Pages
      AllowAutoDeactivate=   True
      Enabled         =   True
      Height          =   664
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   201
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      PanelCount      =   2
      Panels          =   ""
      Scope           =   2
      SelectedPanelIndex=   0
      TabIndex        =   2
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   0
      Transparent     =   False
      Value           =   1
      Visible         =   True
      Width           =   705
      Begin ArkSASpawnPointSetEditor SetEditor
         AllowAutoDeactivate=   True
         AllowFocus      =   False
         AllowFocusRing  =   False
         AllowTabs       =   True
         Backdrop        =   0
         BackgroundColor =   &cFFFFFF00
         Composited      =   False
         Enabled         =   True
         HasBackgroundColor=   False
         Height          =   664
         Index           =   -2147483648
         InitialParent   =   "Pages"
         Left            =   201
         LockBottom      =   True
         LockedInPosition=   False
         LockLeft        =   True
         LockRight       =   True
         LockTop         =   True
         Modified        =   False
         Scope           =   2
         TabIndex        =   0
         TabPanelIndex   =   2
         TabStop         =   True
         Tooltip         =   ""
         Top             =   0
         Transparent     =   True
         Visible         =   True
         Width           =   705
      End
      Begin LogoFillCanvas NoSelectionFillCanvas
         AllowAutoDeactivate=   True
         AllowFocus      =   False
         AllowFocusRing  =   True
         AllowTabs       =   False
         Backdrop        =   0
         Caption         =   "No Selection"
         ContentHeight   =   0
         Enabled         =   True
         Height          =   643
         Index           =   -2147483648
         InitialParent   =   "Pages"
         Left            =   201
         LockBottom      =   True
         LockedInPosition=   False
         LockLeft        =   True
         LockRight       =   True
         LockTop         =   True
         Scope           =   2
         ScrollActive    =   False
         ScrollingEnabled=   False
         ScrollSpeed     =   20
         TabIndex        =   0
         TabPanelIndex   =   1
         TabStop         =   True
         Tooltip         =   ""
         Top             =   0
         Transparent     =   True
         Visible         =   True
         Width           =   705
      End
      Begin StatusBar NoSelectionStatusBar
         AllowAutoDeactivate=   True
         AllowFocus      =   False
         AllowFocusRing  =   True
         AllowTabs       =   False
         Backdrop        =   0
         Borders         =   1
         Caption         =   ""
         ContentHeight   =   0
         Enabled         =   True
         Height          =   21
         Index           =   -2147483648
         InitialParent   =   "Pages"
         Left            =   201
         LockBottom      =   True
         LockedInPosition=   False
         LockLeft        =   True
         LockRight       =   True
         LockTop         =   False
         Scope           =   2
         ScrollActive    =   False
         ScrollingEnabled=   False
         ScrollSpeed     =   20
         TabIndex        =   1
         TabPanelIndex   =   1
         TabStop         =   True
         Tooltip         =   ""
         Top             =   643
         Transparent     =   True
         Visible         =   True
         Width           =   705
      End
   End
   Begin StatusBar SetsStatusBar
      AllowAutoDeactivate=   True
      AllowFocus      =   False
      AllowFocusRing  =   True
      AllowTabs       =   False
      Backdrop        =   0
      Borders         =   3
      Caption         =   ""
      ContentHeight   =   0
      Enabled         =   True
      Height          =   22
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   0
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   2
      ScrollActive    =   False
      ScrollingEnabled=   False
      ScrollSpeed     =   20
      TabIndex        =   4
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   349
      Transparent     =   True
      Visible         =   True
      Width           =   200
   End
   Begin StatusBar LimitsStatusBar
      AllowAutoDeactivate=   True
      AllowFocus      =   False
      AllowFocusRing  =   True
      AllowTabs       =   False
      Backdrop        =   0
      Borders         =   1
      Caption         =   ""
      ContentHeight   =   0
      Enabled         =   True
      Height          =   21
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   0
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   2
      ScrollActive    =   False
      ScrollingEnabled=   False
      ScrollSpeed     =   20
      TabIndex        =   7
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   643
      Transparent     =   True
      Visible         =   True
      Width           =   200
   End
   Begin BeaconListbox SetsList
      AllowAutoDeactivate=   True
      AllowAutoHideScrollbars=   True
      AllowExpandableRows=   False
      AllowFocusRing  =   False
      AllowInfiniteScroll=   False
      AllowResizableColumns=   False
      AllowRowDragging=   False
      AllowRowReordering=   False
      Bold            =   False
      ColumnCount     =   1
      ColumnWidths    =   ""
      DefaultRowHeight=   26
      DefaultSortColumn=   0
      DefaultSortDirection=   0
      DropIndicatorVisible=   False
      EditCaption     =   "Edit"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      GridLineStyle   =   0
      HasBorder       =   False
      HasHeader       =   False
      HasHorizontalScrollbar=   False
      HasVerticalScrollbar=   True
      HeadingIndex    =   -1
      Height          =   308
      Index           =   -2147483648
      InitialParent   =   ""
      InitialValue    =   ""
      Italic          =   False
      Left            =   0
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      PageSize        =   100
      PreferencesKey  =   ""
      RequiresSelection=   False
      RowSelectionType=   1
      Scope           =   2
      TabIndex        =   3
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   41
      TotalPages      =   -1
      Transparent     =   False
      TypeaheadColumn =   0
      Underline       =   False
      Visible         =   True
      VisibleRowCount =   0
      Width           =   200
      _ScrollOffset   =   0
      _ScrollWidth    =   -1
   End
   Begin BeaconListbox LimitsList
      AllowAutoDeactivate=   True
      AllowAutoHideScrollbars=   True
      AllowExpandableRows=   False
      AllowFocusRing  =   False
      AllowInfiniteScroll=   False
      AllowResizableColumns=   False
      AllowRowDragging=   False
      AllowRowReordering=   False
      Bold            =   False
      ColumnCount     =   2
      ColumnWidths    =   "*,75"
      DefaultRowHeight=   26
      DefaultSortColumn=   0
      DefaultSortDirection=   0
      DropIndicatorVisible=   False
      EditCaption     =   "Edit"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      GridLineStyle   =   0
      HasBorder       =   False
      HasHeader       =   False
      HasHorizontalScrollbar=   False
      HasVerticalScrollbar=   True
      HeadingIndex    =   -1
      Height          =   231
      Index           =   -2147483648
      InitialParent   =   ""
      InitialValue    =   ""
      Italic          =   False
      Left            =   0
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      PageSize        =   100
      PreferencesKey  =   ""
      RequiresSelection=   False
      RowSelectionType=   1
      Scope           =   2
      TabIndex        =   6
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   412
      TotalPages      =   -1
      Transparent     =   False
      TypeaheadColumn =   0
      Underline       =   False
      Visible         =   True
      VisibleRowCount =   0
      Width           =   200
      _ScrollOffset   =   0
      _ScrollWidth    =   -1
   End
   Begin OmniBar LimitsToolbar
      Alignment       =   0
      AllowAutoDeactivate=   True
      AllowFocus      =   False
      AllowFocusRing  =   True
      AllowTabs       =   False
      Backdrop        =   0
      BackgroundColor =   ""
      ContentHeight   =   0
      Enabled         =   True
      Height          =   41
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   0
      LeftPadding     =   -1
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      RightPadding    =   -1
      Scope           =   2
      ScrollActive    =   False
      ScrollingEnabled=   False
      ScrollSpeed     =   20
      TabIndex        =   8
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   371
      Transparent     =   True
      Visible         =   True
      Width           =   200
   End
   Begin OmniBar SetsToolbar
      Alignment       =   0
      AllowAutoDeactivate=   True
      AllowFocus      =   False
      AllowFocusRing  =   True
      AllowTabs       =   False
      Backdrop        =   0
      BackgroundColor =   ""
      ContentHeight   =   0
      Enabled         =   True
      Height          =   41
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   0
      LeftPadding     =   -1
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      RightPadding    =   -1
      Scope           =   2
      ScrollActive    =   False
      ScrollingEnabled=   False
      ScrollSpeed     =   20
      TabIndex        =   9
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   0
      Transparent     =   True
      Visible         =   True
      Width           =   200
   End
End
#tag EndDesktopWindow

#tag WindowCode
	#tag Event
		Sub ContentsChanged()
		  RaiseEvent Changed
		End Sub
	#tag EndEvent

	#tag Event
		Sub Resize(Initial As Boolean)
		  #Pragma Unused Initial
		  
		  Self.SetsListWidth = Preferences.ArkSASpawnPointEditorSetsSplitterPosition
		  Self.LimitsListHeight = Preferences.ArkSASpawnPointEditorLimitsSplitterPosition
		  
		  Var Resizer As OmniBarItem = Self.SetsToolbar.Item("Resizer")
		  If (Resizer Is Nil) = False Then
		    Resizer.Enabled = Self.Width > Self.MinEditorWidth
		  End If
		End Sub
	#tag EndEvent


	#tag Method, Flags = &h0
		Function GoToChild(SpawnSetId As String) As Boolean
		  For Idx As Integer = 0 To Self.SetsList.LastRowIndex
		    Var Organizer As ArkSA.SpawnSetOrganizer = Self.SetsList.RowTagAt(Idx)
		    If Organizer Is Nil Then
		      Continue
		    End If
		    
		    Var SpawnSet As ArkSA.SpawnPointSet = Organizer.Template
		    If SpawnSet Is Nil Or SpawnSet.SetId <> SpawnSetId Then
		      Continue
		    End If
		    
		    Self.SetsList.SelectedRowIndex = Idx
		    Self.SetsList.EnsureSelectionIsVisible()
		    Return True
		  Next Idx
		  
		  Self.SetsList.SelectedRowIndex = -1
		  Return False
		End Function
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Function LimitsListHeight() As Integer
		  Return Self.Height - Self.LimitsToolbar.Top
		End Function
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub LimitsListHeight(Assigns Value As Integer)
		  // Remember, this works BACKWARDS so a value of 100 means 100 from the bottom of the window
		  
		  Const SetsListMinHeight = 200
		  
		  Var MinTop As Integer = SetsListMinHeight
		  Var MaxTop As Integer = Self.Height - LimitsListMinHeight
		  Var Top As Integer = Max(Min(Self.Height - Value, MaxTop), MinTop)
		  Value = Self.Height - Top
		  
		  Self.LimitsToolbar.Top = Top
		  Self.LimitsList.Top = Self.LimitsToolbar.Top + Self.LimitsToolbar.Height
		  Self.LimitsList.Height = Self.LimitsStatusBar.Top - Self.LimitsList.Top
		  
		  Self.SetsStatusBar.Top = Top - Self.SetsStatusBar.Height
		  Self.SetsList.Height = Self.SetsStatusBar.Top - Self.SetsList.Top
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Shared Function MinEditorWidth() As Integer
		  Return SetsListMinWidth + ArkSpawnPointSetEditor.MinEditorWidth
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Function Overrides() As ArkSA.SpawnPointOverride()
		  Var Overrides() As ArkSA.SpawnPointOverride
		  Overrides.ResizeTo(Self.mOverrides.LastIndex)
		  For Idx As Integer = 0 To Self.mOverrides.LastIndex
		    Overrides(Idx) = New ArkSA.SpawnPointOverride(Self.mOverrides(Idx))
		  Next
		  Return Overrides
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub Overrides(Assigns Overrides() As ArkSA.SpawnPointOverride)
		  If Overrides Is Nil Then
		    Self.mOverrides.ResizeTo(-1)
		  Else
		    Self.mOverrides.ResizeTo(Overrides.LastIndex)
		    For I As Integer = 0 To Overrides.LastIndex
		      Self.mOverrides(I) = New ArkSA.MutableSpawnPointOverride(Overrides(I))
		    Next
		  End If
		  
		  Self.UpdateUI
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub PresentLimitsDialog()
		  Var SelectedCreatures() As ArkSA.BlueprintReference
		  Self.PresentLimitsDialog(SelectedCreatures)
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub PresentLimitsDialog(SelectedCreatures() As ArkSA.BlueprintReference)
		  Var DefinedCreatures() As ArkSA.BlueprintReference
		  Var CommonLimit As NullableDouble
		  Var CreatureFilter As New Dictionary
		  
		  For Each Override As ArkSA.SpawnPointOverride In Self.mOverrides
		    Var LimitedCreatureRefs() As ArkSA.BlueprintReference = Override.LimitedCreatureRefs
		    For Each CreatureRef As ArkSA.BlueprintReference In LimitedCreatureRefs
		      If DefinedCreatures.IndexOf(CreatureRef) = -1 Then
		        DefinedCreatures.Add(CreatureRef)
		      End If
		      If SelectedCreatures.IndexOf(CreatureRef) > -1 Then
		        Var CreatureLimit As Double = Override.Limit(CreatureRef)
		        If CommonLimit Is Nil Then
		          CommonLimit = CreatureLimit
		        ElseIf CommonLimit <> -1.0 And CommonLimit <> CreatureLimit Then
		          CommonLimit = -1.0
		        End If
		      End If
		    Next
		    
		    For Each Set As ArkSA.SpawnPointSet In Override
		      Var Entries() As ArkSA.SpawnPointSetEntry = Set.Entries
		      For Each Entry As ArkSA.SpawnPointSetEntry In Entries
		        Var CreatureRef As ArkSA.BlueprintReference = Entry.CreatureReference
		        CreatureFilter.Value(CreatureRef.BlueprintId) = CreatureRef
		      Next
		    Next
		  Next
		  
		  Var CreaturesInSpawnPoint() As ArkSA.BlueprintReference
		  For Each Entry As DictionaryEntry In CreatureFilter
		    CreaturesInSpawnPoint.Add(Entry.Value)
		  Next
		  
		  If (CommonLimit Is Nil) = False And CommonLimit = -1.0 Then
		    CommonLimit = Nil
		  End If
		  
		  Var Limit As NullableDouble = ArkSASpawnPointLimitDialog.Present(Self, Self.Project.ContentPacks, CommonLimit, SelectedCreatures, DefinedCreatures, CreaturesInSpawnPoint)
		  If (Limit Is Nil) = False Then
		    For Each Override As ArkSA.MutableSpawnPointOverride In Self.mOverrides
		      For Each CreatureRef As ArkSA.BlueprintReference In SelectedCreatures
		        Override.Limit(CreatureRef) = Limit
		      Next
		    Next
		    
		    Self.UpdateUI
		    RaiseEvent Changed
		  End If
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Function Project() As ArkSA.Project
		  Return RaiseEvent GetProject
		End Function
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Function SetsListWidth() As Integer
		  Return Self.SetsList.Width
		End Function
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub SetsListWidth(Assigns Value As Integer)
		  Var ListWidth, EditorWidth As Integer
		  If Self.Width <= Self.MinEditorWidth Then
		    ListWidth = Self.SetsListMinWidth
		    EditorWidth = ArkSpawnPointSetEditor.MinEditorWidth
		  Else
		    Var AvailableSpace As Integer = Self.Width - Self.ColumnSeparator.Width
		    ListWidth = Min(Max(Value, Self.SetsListMinWidth), AvailableSpace - ArkSpawnPointSetEditor.MinEditorWidth)
		    EditorWidth = AvailableSpace - ListWidth
		  End If
		  
		  Self.SetsList.Width = ListWidth
		  Self.SetsToolbar.Width = ListWidth
		  Self.SetsStatusBar.Width = ListWidth
		  Self.ColumnSeparator.Left = ListWidth
		  Self.LimitsList.Width = ListWidth
		  Self.LimitsToolbar.Width = ListWidth
		  Self.LimitsStatusBar.Width = ListWidth
		  Self.Pages.Left = Self.ColumnSeparator.Left + Self.ColumnSeparator.Width
		  Self.Pages.Width = EditorWidth
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub UpdateLimitsList()
		  Var SelectedCreatureRefs() As ArkSA.BlueprintReference
		  For I As Integer = 0 To Self.LimitsList.RowCount - 1
		    If Self.LimitsList.RowSelectedAt(I) Then
		      Var Ref As ArkSA.BlueprintReference = Self.LimitsList.RowTagAt(I)
		      SelectedCreatureRefs.Add(Ref)
		    End If
		  Next
		  Self.UpdateLimitsList(SelectedCreatureRefs)
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub UpdateLimitsList(SelectCreatures() As ArkSA.BlueprintReference)
		  If SelectCreatures Is Nil Then
		    Self.UpdateLimitsList()
		    Return
		  End If
		  
		  Self.LimitsList.SelectionChangeBlocked = True
		  
		  Const MixedLimitValue = -1.0
		  
		  Var CombinedLimits As Dictionary
		  Var CombinedRefs As New Dictionary
		  For Each Override As ArkSA.MutableSpawnPointOverride In Self.mOverrides
		    Var LimitedCreatureRefs() As ArkSA.BlueprintReference = Override.LimitedCreatureRefs
		    If CombinedLimits Is Nil Then
		      CombinedLimits = New Dictionary
		      For Each CreatureRef As ArkSA.BlueprintReference In LimitedCreatureRefs
		        Var Limit As Double = Override.Limit(CreatureRef)
		        CombinedLimits.Value(CreatureRef.BlueprintId) = Limit
		        
		        If CombinedRefs.HasKey(CreatureRef.BlueprintId) = False Then
		          CombinedRefs.Value(CreatureRef.BlueprintId) = CreatureRef
		        End If
		      Next
		    Else
		      For Each CreatureRef As ArkSA.BlueprintReference In LimitedCreatureRefs
		        Var Limit As Double = Override.Limit(CreatureRef)
		        If CombinedLimits.HasKey(CreatureRef.BlueprintId) = False Then
		          CombinedLimits.Value(CreatureRef.BlueprintId) = Limit
		        ElseIf CombinedLimits.Value(CreatureRef.BlueprintId).DoubleValue <> Limit Then
		          CombinedLimits.Value(CreatureRef.BlueprintId) = MixedLimitValue
		        End If
		        
		        If CombinedRefs.HasKey(CreatureRef.BlueprintId) = False Then
		          CombinedRefs.Value(CreatureRef.BlueprintId) = CreatureRef
		        End If
		      Next
		    End If
		  Next
		  
		  If (CombinedLimits Is Nil) = False And CombinedLimits.KeyCount > 0 Then
		    Var SelectCreatureIds() As String
		    For Each CreatureRef As ArkSA.BlueprintReference In SelectCreatures
		      SelectCreatureIds.Add(CreatureRef.BlueprintId)
		    Next
		    
		    Self.LimitsList.RowCount = CombinedLimits.KeyCount
		    For RowIndex As Integer = 0 To CombinedLimits.KeyCount - 1
		      Var CreatureId As String = CombinedLimits.Key(RowIndex)
		      Var CreatureRef As ArkSA.BlueprintReference = CombinedRefs.Value(CreatureId)
		      Var Limit As Double = CombinedLimits.Value(CreatureId)
		      Var Creature As ArkSA.Blueprint = CreatureRef.Resolve()
		      If (Creature Is Nil) Then
		        Self.LimitsList.CellTextAt(RowIndex, 0) = "Unknown Creature"
		      Else
		        Self.LimitsList.CellTextAt(RowIndex, 0) = Creature.Label
		      End If
		      
		      Self.LimitsList.CellTextAt(RowIndex, 1) = If(Limit = MixedLimitValue, "Mixed", Beacon.PrettyText(Limit * 100, 2) + "%")
		      Self.LimitsList.RowTagAt(RowIndex) = CreatureRef
		      Self.LimitsList.RowSelectedAt(RowIndex) = SelectCreatureIds.IndexOf(CreatureId) > -1
		    Next
		  Else
		    Self.LimitsList.RowCount = 0
		  End If
		  
		  Self.UpdateLimitsStatus
		  
		  Self.LimitsList.SortingColumn = 0
		  Self.LimitsList.Sort
		  Self.LimitsList.SelectionChangeBlocked = False
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub UpdateLimitsList(SelectCreatures() As ArkSA.Creature)
		  If SelectCreatures Is Nil Then
		    Self.UpdateLimitsList()
		    Return
		  End If
		  
		  Var SelectedCreatureRefs() As ArkSA.BlueprintReference
		  For Each Creature As ArkSA.Creature In SelectCreatures
		    If Creature Is Nil Then
		      Continue
		    End If
		    
		    SelectedCreatureRefs.Add(New ArkSA.BlueprintReference(Creature))
		  Next
		  Self.UpdateLimitsList(SelectedCreatureRefs)
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub UpdateLimitsStatus()
		  If Self.LimitsList.SelectedRowCount > 0 Then
		    Self.LimitsStatusBar.Caption = Self.LimitsList.SelectedRowCount.ToString + " of " + Language.NounWithQuantity(Self.LimitsList.RowCount, "Limit", "Limits") + " Selected"
		  Else
		    Self.LimitsStatusBar.Caption = Language.NounWithQuantity(Self.LimitsList.RowCount, "Limit", "Limits")
		  End If
		  
		  Var EditButton As OmniBarItem = Self.LimitsToolbar.Item("EditButton")
		  If (EditButton Is Nil) = False Then
		    EditButton.Enabled = Self.LimitsList.SelectedRowCount > 0
		  End If
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub UpdateSetsList(SelectSets() As ArkSA.SpawnPointSet = Nil)
		  Self.SetsList.SelectionChangeBlocked = True
		  
		  Var CombinedSets As New Dictionary
		  For Each Override As ArkSA.MutableSpawnPointOverride In Self.mOverrides
		    For Each Set As ArkSA.SpawnPointSet In Override
		      Var Hash As String = Set.Hash
		      Var Organizer As ArkSA.SpawnSetOrganizer
		      If CombinedSets.HasKey(Hash) Then
		        Organizer = CombinedSets.Value(Hash)
		      Else
		        Organizer = New ArkSA.SpawnSetOrganizer(Set)
		        CombinedSets.Value(Hash) = Organizer
		      End If
		      Organizer.Attach(Override, Set)
		    Next
		  Next
		  
		  If CombinedSets <> Nil And CombinedSets.KeyCount > 0 Then
		    Var SelectedSets() As String
		    If SelectSets = Nil Then
		      For I As Integer = 0 To Self.SetsList.RowCount - 1
		        If Self.SetsList.RowSelectedAt(I) Then
		          SelectedSets.Add(ArkSA.SpawnSetOrganizer(Self.SetsList.RowTagAt(I)).Template.SetId)
		        End If
		      Next
		    Else
		      For Each Set As ArkSA.SpawnPointSet In SelectSets
		        SelectedSets.Add(Set.Hash)
		      Next
		    End If
		    
		    Var ExtendedLabels As Boolean = Self.mOverrides.Count > 1
		    
		    Self.SetsList.RowCount = CombinedSets.KeyCount
		    Self.SetsList.DefaultRowHeight = If(ExtendedLabels, 34, 26)
		    For RowIndex As Integer = 0 To CombinedSets.KeyCount - 1
		      Var Hash As String = CombinedSets.Key(RowIndex)
		      Var Organizer As ArkSA.SpawnSetOrganizer = CombinedSets.Value(Hash)
		      
		      Self.SetsList.CellTextAt(RowIndex, 0) = Organizer.Label(ExtendedLabels)
		      Self.SetsList.RowTagAt(RowIndex) = Organizer
		      Self.SetsList.RowSelectedAt(RowIndex) = Organizer.Matches(SelectedSets)
		    Next
		  Else
		    Self.SetsList.RowCount = 0
		  End If
		  
		  Self.UpdateSetsStatus
		  
		  Self.SetsList.SortingColumn = 0
		  Self.SetsList.Sort
		  Self.SetsList.SelectionChangeBlocked = False
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub UpdateSetsStatus()
		  If Self.SetsList.SelectedRowCount > 0 Then
		    Self.SetsStatusBar.Caption = Self.SetsList.SelectedRowCount.ToString + " of " + Language.NounWithQuantity(Self.SetsList.RowCount, "Spawn Set", "Spawn Sets") + " Selected"
		  Else
		    Self.SetsStatusBar.Caption = Language.NounWithQuantity(Self.SetsList.RowCount, "Spawn Set", "Spawn Sets")
		  End If
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub UpdateUI()
		  Self.UpdateSetsList()
		  Self.UpdateLimitsList()
		End Sub
	#tag EndMethod


	#tag Hook, Flags = &h0
		Event Changed()
	#tag EndHook

	#tag Hook, Flags = &h0
		Event GetProject() As ArkSA.Project
	#tag EndHook


	#tag Property, Flags = &h21
		Private mOverrides() As ArkSA.MutableSpawnPointOverride
	#tag EndProperty


	#tag Constant, Name = kLimitsClipboardType, Type = String, Dynamic = False, Default = \"com.thezaz.beacon.arksa.spawn.limit", Scope = Private
	#tag EndConstant

	#tag Constant, Name = kSetsClipboardType, Type = String, Dynamic = False, Default = \"com.thezaz.beacon.arksa.spawn.set", Scope = Private
	#tag EndConstant

	#tag Constant, Name = LimitsListDefaultHeight, Type = Double, Dynamic = False, Default = \"192", Scope = Public
	#tag EndConstant

	#tag Constant, Name = LimitsListMinHeight, Type = Double, Dynamic = False, Default = \"150", Scope = Public
	#tag EndConstant

	#tag Constant, Name = PageNoSelection, Type = Double, Dynamic = False, Default = \"0", Scope = Private
	#tag EndConstant

	#tag Constant, Name = PageSetEditor, Type = Double, Dynamic = False, Default = \"1", Scope = Private
	#tag EndConstant

	#tag Constant, Name = SetsListDefaultWidth, Type = Double, Dynamic = False, Default = \"310", Scope = Public
	#tag EndConstant

	#tag Constant, Name = SetsListMinWidth, Type = Double, Dynamic = False, Default = \"225", Scope = Public
		#Tag Instance, Platform = Windows, Language = Default, Definition  = \"217"
	#tag EndConstant


#tag EndWindowCode

#tag Events SetEditor
	#tag Event
		Sub Changed()
		  If Self.SetsList.SelectedRowCount <> 1 Then
		    Break
		    Return
		  End If
		  
		  Var Organizer As ArkSA.SpawnSetOrganizer = Self.SetsList.RowTagAt(Self.SetsList.SelectedRowIndex)
		  Organizer.Replicate()
		  
		  Self.SetsList.CellTextAt(Self.SetsList.SelectedRowIndex, 0) = Organizer.Label(Self.mOverrides.Count > 1)
		  
		  RaiseEvent Changed
		End Sub
	#tag EndEvent
	#tag Event
		Function GetProject() As ArkSA.Project
		  Return Self.Project
		End Function
	#tag EndEvent
#tag EndEvents
#tag Events SetsList
	#tag Event
		Sub SelectionChanged()
		  Self.UpdateSetsStatus()
		  
		  If Me.SelectedRowCount = 1 Then
		    Self.Pages.SelectedPanelIndex = Self.PageSetEditor
		    Self.SetEditor.SpawnSet = ArkSA.SpawnSetOrganizer(Me.RowTagAt(Me.SelectedRowIndex)).Template
		    Return
		  End If
		  
		  Self.SetEditor.SpawnSet = Nil
		  Self.Pages.SelectedPanelIndex = Self.PageNoSelection
		  Self.NoSelectionFillCanvas.Caption = If(Me.SelectedRowCount = 0, "No Selection", "Multiple Selection")
		End Sub
	#tag EndEvent
	#tag Event
		Function CanDelete() As Boolean
		  Return Me.SelectedRowCount > 0
		End Function
	#tag EndEvent
	#tag Event
		Sub PerformClear(Warn As Boolean)
		  Var Organizers() As ArkSA.SpawnSetOrganizer
		  Var Bound As Integer = Me.RowCount - 1
		  For I As Integer = 0 To Bound
		    If Me.RowSelectedAt(I) = False Then
		      Continue
		    End If
		    
		    Organizers.Add(Me.RowTagAt(I))
		  Next
		  
		  If Warn And Self.ShowDeleteConfirmation(Organizers, "spawn set", "spawn sets") = False Then
		    Return
		  End If
		  
		  For Each Organizer As ArkSA.SpawnSetOrganizer In Organizers
		    Var Overrides() As ArkSA.MutableSpawnPointOverride = Organizer.Overrides
		    For Each Override As ArkSA.MutableSpawnPointOverride In Overrides
		      Var Set As ArkSA.SpawnPointSet = Organizer.SetForOverride(Override)
		      Override.Remove(Set)
		    Next
		  Next
		  
		  RaiseEvent Changed
		  Self.UpdateSetsList()
		End Sub
	#tag EndEvent
	#tag Event
		Function CanCopy() As Boolean
		  Return Me.SelectedRowCount > 0
		End Function
	#tag EndEvent
	#tag Event
		Function CanPaste(Board As Clipboard) As Boolean
		  Return Board.HasClipboardData(Self.kSetsClipboardType)
		End Function
	#tag EndEvent
	#tag Event
		Sub PerformCopy(Board As Clipboard)
		  Var Items() As Dictionary
		  For I As Integer = 0 To Me.RowCount - 1
		    If Not Me.RowSelectedAt(I) Then
		      Continue
		    End If
		    
		    Var Organizer As ArkSA.SpawnSetOrganizer = Me.RowTagAt(I)
		    Items.Add(Organizer.Template.SaveData)
		  Next
		  
		  If Items.Count = 0 Then
		    System.Beep
		    Return
		  End If
		  
		  Board.AddClipboardData(Self.kSetsClipboardType, Items)
		End Sub
	#tag EndEvent
	#tag Event
		Sub PerformPaste(Board As Clipboard)
		  Var Contents As Variant = Board.GetClipboardData(Self.kSetsClipboardType)
		  If Contents.IsNull = False Then
		    Try
		      Var Dicts() As Variant = Contents
		      Var SelectSets() As ArkSA.SpawnPointSet
		      For Each Dict As Dictionary In Dicts
		        Var Set As ArkSA.SpawnPointSet = ArkSA.SpawnPointSet.FromSaveData(Dict)
		        If Set Is Nil Then
		          Continue
		        End If
		        
		        For Each Override As ArkSA.MutableSpawnPointOverride In Self.mOverrides
		          Override.Add(Set)
		        Next
		        
		        SelectSets.Add(Set)
		      Next
		      
		      If SelectSets.Count > 0 Then
		        RaiseEvent Changed
		        Self.UpdateSetsList(SelectSets)
		      End If
		    Catch Err As RuntimeException
		      Self.ShowAlert("There was an error with the pasted content.", "The content is not formatted correctly.")
		    End Try
		    Return
		  End If
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events LimitsList
	#tag Event
		Sub Opening()
		  Me.ColumnAlignmentAt(1) = DesktopListbox.Alignments.Right
		End Sub
	#tag EndEvent
	#tag Event
		Sub SelectionChanged()
		  Self.UpdateLimitsStatus
		End Sub
	#tag EndEvent
	#tag Event
		Sub DoublePressed()
		  Var SelectedCreatures() As ArkSA.BlueprintReference
		  For I As Integer = 0 To Self.LimitsList.RowCount - 1
		    If Self.LimitsList.RowSelectedAt(I) Then
		      Var Ref As ArkSA.BlueprintReference = Self.LimitsList.RowTagAt(I)
		      SelectedCreatures.Add(Ref)
		    End If
		  Next
		  Self.PresentLimitsDialog(SelectedCreatures)
		End Sub
	#tag EndEvent
	#tag Event
		Function CanDelete() As Boolean
		  Return Me.SelectedRowCount > 0
		End Function
	#tag EndEvent
	#tag Event
		Sub PerformClear(Warn As Boolean)
		  Var CreatureRefs() As ArkSA.BlueprintReference
		  For I As Integer = 0 To Me.RowCount - 1
		    If Me.RowSelectedAt(I) = False Then
		      Continue
		    End If
		    
		    CreatureRefs.Add(Me.RowTagAt(I))
		  Next
		  
		  If Warn And Self.ShowDeleteConfirmation(CreatureRefs, "creature limit", "creature limits") = False Then
		    Return
		  End If
		  
		  For Each CreatureRef As ArkSA.BlueprintReference In CreatureRefs
		    For Each Override As ArkSA.MutableSpawnPointOverride In Self.mOverrides
		      Override.Limit(CreatureRef) = 1.0
		    Next
		  Next
		  
		  RaiseEvent Changed
		  Self.UpdateLimitsList()
		End Sub
	#tag EndEvent
	#tag Event
		Function CanCopy() As Boolean
		  Return Me.SelectedRowCount > 0
		End Function
	#tag EndEvent
	#tag Event
		Function CanPaste(Board As Clipboard) As Boolean
		  Return Board.HasClipboardData(Self.kLimitsClipboardType)
		End Function
	#tag EndEvent
	#tag Event
		Sub PerformCopy(Board As Clipboard)
		  Var Limits() As Dictionary
		  For I As Integer = 0 To Me.RowCount - 1
		    If Me.RowSelectedAt(I) = False Then
		      Continue
		    End If
		    
		    Var CreatureRef As ArkSA.BlueprintReference = Me.RowTagAt(I)
		    Var CommonLimit As NullableDouble
		    For Each Override As ArkSA.SpawnPointOverride In Self.mOverrides
		      Var Limit As Double = Override.Limit(CreatureRef)
		      If Limit >= 1.0 Or Limit < 0.0 Then
		        Continue
		      End If
		      
		      If CommonLimit Is Nil Then
		        CommonLimit = Limit
		      ElseIf CommonLimit <> Limit Then
		        Continue For I
		      End If
		    Next
		    
		    If (CommonLimit Is Nil) = False Then
		      Var LimitDict As New Dictionary
		      LimitDict.Value("creature") = CreatureRef.SaveData
		      LimitDict.Value("maxPercentage") = CommonLimit.DoubleValue
		      Limits.Add(LimitDict)
		    End If
		  Next
		  
		  If Limits.Count = 0 Then
		    System.Beep
		    Return
		  End If
		  
		  Board.AddClipboardData(Self.kLimitsClipboardType, Limits)
		End Sub
	#tag EndEvent
	#tag Event
		Sub PerformPaste(Board As Clipboard)
		  Var Contents As Variant = Board.GetClipboardData(Self.kLimitsClipboardType)
		  If Contents.IsNull Then
		    Return
		  End If
		  
		  Try
		    Var Limits() As Variant = Contents
		    Var SelectCreatures() As ArkSA.BlueprintReference
		    For Each LimitDict As Dictionary In Limits
		      Var CreatureRef As ArkSA.BlueprintReference = ArkSA.BlueprintReference.FromSaveData(LimitDict.Value("creature"))
		      SelectCreatures.Add(CreatureRef)
		      
		      Var Limit As Double = LimitDict.Value("maxPercentage")
		      For Each Override As ArkSA.MutableSpawnPointOverride In Self.mOverrides
		        Override.Limit(CreatureRef) = Limit
		      Next
		    Next
		    
		    If SelectCreatures.Count > 0 Then
		      RaiseEvent Changed
		      Self.UpdateLimitsList(SelectCreatures)
		    End If
		  Catch Err As RuntimeException
		    Self.ShowAlert("There was an error with the pasted content.", "The content is not formatted correctly.")
		  End Try
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events LimitsToolbar
	#tag Event
		Sub ItemPressed(Item As OmniBarItem, ItemRect As Rect)
		  #Pragma Unused ItemRect
		  
		  Select Case Item.Name
		  Case "AddButton"
		    Self.PresentLimitsDialog()
		  Case "EditButton"
		    Var SelectedCreatures() As ArkSA.BlueprintReference
		    For I As Integer = 0 To Self.LimitsList.RowCount - 1
		      If Self.LimitsList.RowSelectedAt(I) Then
		        Var Ref As ArkSA.BlueprintReference = Self.LimitsList.RowTagAt(I)
		        SelectedCreatures.Add(Ref)
		      End If
		    Next
		    Self.PresentLimitsDialog(SelectedCreatures)
		  End Select
		End Sub
	#tag EndEvent
	#tag Event
		Sub Opening()
		  Me.Append(OmniBarItem.CreateTitle("LimitsTitle", "Limits"))
		  Me.Append(OmniBarItem.CreateSeparator("LimitsTitleSeparator"))
		  Me.Append(OmniBarItem.CreateButton("AddButton", "New Limit", IconToolbarAdd, "Define a new creature limit."))
		  Me.Append(OmniBarItem.CreateButton("EditButton", "Edit", IconToolbarEdit, "Edit the selected creature limit or limits.", False))
		  Me.Append(OmniBarItem.CreateFlexibleSpace)
		  Me.Append(OmniBarItem.CreateVerticalResizer("Resizer"))
		  
		  Me.Item("LimitsTitle").Priority = 5
		  Me.Item("LimitsTitleSeparator").Priority = 5
		End Sub
	#tag EndEvent
	#tag Event
		Sub Resize(DraggedResizer As OmniBarItem, DeltaX As Integer, DeltaY As Integer)
		  #Pragma Unused DraggedResizer
		  #Pragma Unused DeltaX
		  
		  Self.LimitsListHeight = Self.LimitsListHeight - DeltaY
		End Sub
	#tag EndEvent
	#tag Event
		Sub ResizeFinished(DraggedResizer As OmniBarItem)
		  #Pragma Unused DraggedResizer
		  
		  Preferences.ArkSASpawnPointEditorLimitsSplitterPosition = Self.LimitsListHeight
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events SetsToolbar
	#tag Event
		Sub ItemPressed(Item As OmniBarItem, ItemRect As Rect)
		  #Pragma Unused ItemRect
		  
		  Select Case Item.Name
		  Case "AddButton"
		    Var Organizer As New ArkSA.SpawnSetOrganizer
		    For Each Override As ArkSA.MutableSpawnPointOverride In Self.mOverrides
		      Organizer.Attach(Override)
		    Next
		    
		    Self.SetsList.AddRow(Organizer.Label(Self.mOverrides.Count > 1))
		    Self.SetsList.RowTagAt(Self.SetsList.LastAddedRowIndex) = Organizer
		    Self.SetsList.SelectedRowIndex = Self.SetsList.LastAddedRowIndex
		    Self.SetsList.Sort
		    Self.SetsList.EnsureSelectionIsVisible
		  Case "WizardButton"
		    Var Organizer As New ArkSA.SpawnSetOrganizer
		    For Each Override As ArkSA.MutableSpawnPointOverride In Self.mOverrides
		      Organizer.Attach(Override)
		    Next
		    
		    If ArkSASpawnSetWizard.Present(Self, Organizer, Self.Project.ContentPacks) = False Then
		      Return
		    End If
		    
		    Self.SetsList.AddRow(Organizer.Label(Self.mOverrides.Count > 1))
		    Self.SetsList.RowTagAt(Self.SetsList.LastRowIndex) = Organizer
		    Self.SetsList.SelectedRowIndex = Self.SetsList.LastRowIndex
		    Self.SetsList.Sort
		    Self.SetsList.EnsureSelectionIsVisible
		    
		    Self.UpdateLimitsList
		    
		    RaiseEvent Changed
		  End Select
		End Sub
	#tag EndEvent
	#tag Event
		Sub Opening()
		  Me.Append(OmniBarItem.CreateTitle("SetsTitle", "Spawn Sets"))
		  Me.Append(OmniBarItem.CreateSeparator("SetsTitleSeparator"))
		  Me.Append(OmniBarItem.CreateButton("AddButton", "New Set", IconToolbarAdd, "Create a new spawn set."))
		  Me.Append(OmniBarItem.CreateButton("WizardButton", "Auto Creature", IconToolbarWizard, "Quickly add a creature to this spawn point using a wizard."))
		  Me.Append(OmniBarItem.CreateFlexibleSpace)
		  Me.Append(OmniBarItem.CreateHorizontalResizer("Resizer"))
		  
		  Me.Item("SetsTitle").Priority = 5
		  Me.Item("SetsTitleSeparator").Priority = 5
		End Sub
	#tag EndEvent
	#tag Event
		Sub Resize(DraggedResizer As OmniBarItem, DeltaX As Integer, DeltaY As Integer)
		  #Pragma Unused DraggedResizer
		  #Pragma Unused DeltaY
		  
		  Self.SetsListWidth = Self.SetsListWidth + DeltaX
		End Sub
	#tag EndEvent
	#tag Event
		Sub ResizeFinished(DraggedResizer As OmniBarItem)
		  #Pragma Unused DraggedResizer
		  
		  Preferences.ArkSASpawnPointEditorSetsSplitterPosition = Self.SetsListWidth
		End Sub
	#tag EndEvent
#tag EndEvents
#tag ViewBehavior
	#tag ViewProperty
		Name="Modified"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Composited"
		Visible=true
		Group="Window Behavior"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Index"
		Visible=true
		Group="ID"
		InitialValue="-2147483648"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Name"
		Visible=true
		Group="ID"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Super"
		Visible=true
		Group="ID"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Width"
		Visible=true
		Group="Size"
		InitialValue="300"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Height"
		Visible=true
		Group="Size"
		InitialValue="300"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="InitialParent"
		Visible=false
		Group="Position"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Left"
		Visible=true
		Group="Position"
		InitialValue="0"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Top"
		Visible=true
		Group="Position"
		InitialValue="0"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockLeft"
		Visible=true
		Group="Position"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockTop"
		Visible=true
		Group="Position"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockRight"
		Visible=true
		Group="Position"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockBottom"
		Visible=true
		Group="Position"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="TabIndex"
		Visible=true
		Group="Position"
		InitialValue="0"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="TabPanelIndex"
		Visible=false
		Group="Position"
		InitialValue="0"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="TabStop"
		Visible=true
		Group="Position"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="AllowAutoDeactivate"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Enabled"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Tooltip"
		Visible=true
		Group="Appearance"
		InitialValue=""
		Type="String"
		EditorType="MultiLineEditor"
	#tag EndViewProperty
	#tag ViewProperty
		Name="AllowFocusRing"
		Visible=true
		Group="Appearance"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Visible"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="BackgroundColor"
		Visible=true
		Group="Background"
		InitialValue="&hFFFFFF"
		Type="ColorGroup"
		EditorType="ColorGroup"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Backdrop"
		Visible=true
		Group="Background"
		InitialValue=""
		Type="Picture"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasBackgroundColor"
		Visible=true
		Group="Background"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="AllowFocus"
		Visible=true
		Group="Behavior"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="AllowTabs"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Transparent"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
#tag EndViewBehavior
