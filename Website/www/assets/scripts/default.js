(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t,n){for(var r=0;r<n.length;r++){var o=n[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,i=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===e(i)?i:String(i)),o)}var i}var n=function(){function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)}var r,o;return r=n,o=[{key:"prepareResponse",value:function(e){return{xhr:e,status:e.status,statusText:e.statusText,body:e.responseText,success:e.status>=200&&e.status<300||304===e.status}}},{key:"start",value:function(t,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new Promise((function(l,a){var s=new XMLHttpRequest;if(s.open(t,n,!0),"object"===e(i)&&null!==i&&!1===Array.isArray(i))for(var u=0,c=Object.keys(i);u<c.length;u++){var d=c[u];s.setRequestHeader(d,i[d])}s.onload=function(){var e=r.prepareResponse(s);e.success?l(e):a(e)},s.onerror=function(){a(r.prepareResponse(s))},s.send(o)}))}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.start("GET",e,null,t)}},{key:"post",value:function(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r instanceof URLSearchParams?(o["Content-Type"]="application/x-www-form-urlencoded",n.start("POST",t,r.toString(),o)):"object"===e(r)&&null!==r||Array.isArray(r)?(o["Content-Type"]="application/json",n.start("POST",t,JSON.stringify(r),o)):n.start("POST",t,r,o)}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.start("DELETE",e,null,t)}}],null&&t(r.prototype,null),o&&t(r,o),Object.defineProperty(r,"prototype",{writable:!1}),n}();function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function l(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===r(t)?t:String(t)}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,r=[{key:"init",value:function(){var e=this;this.container=document.getElementById("explore_container"),this.popover=document.getElementById("explore_popover"),this.field=document.getElementById("explore_search_field"),this.link=document.getElementById("menu_explore_link"),this.container&&this.popover&&this.field&&this.link&&(this.container.addEventListener("click",(function(t){return e.dismiss(),t.stopPropagation(),t.stopImmediatePropagation(),!1})),this.popover.addEventListener("click",(function(e){return e.stopPropagation(),e.stopImmediatePropagation(),!1})),this.link.addEventListener("click",(function(t){return t.stopPropagation(),t.preventDefault(),t.stopImmediatePropagation(),e.toggle(),!1})),this.field.addEventListener("input",(function(t){t.target.searchTimeout&&(clearTimeout(t.target.searchTimeout),t.target.searchTimeout=null),t.target.searchTimeout=setTimeout((function(){e.search(e.field.value)}),1e3)})),document.getElementById("explore_results_back").addEventListener("click",(function(){e.search("")})),document.getElementById("explore_results_more").addEventListener("click",(function(){window.location=e.searchMoreURL})),window.addEventListener("blur",(function(){e.dismiss()})))}},{key:"toggle",value:function(){"none"===this.container.style.display||""===this.container.style.display?this.present():this.dismiss()}},{key:"dismiss",value:function(){"none"!==this.container.style.display&&(this.container.style.display="none",this.link.className="",this.field.value="",this.displayResults())}},{key:"present",value:function(){if("block"!==this.container.style.display){var e=this.link.getBoundingClientRect();this.popover.style.top=e.bottom+"px",this.popover.style.left=Math.max(e.left+(e.width-320)/2,20)+"px",this.container.style.display="block",this.link.className="expanded"}}},{key:"search",value:function(e){var t=this;if(e||(e=""),this.field.value!==e&&(this.field.value=e),""!==e){var r=new URLSearchParams;r.append("query",e.trim()),r.append("count",4),n.get("/search?".concat(r.toString()),{Accept:"application/json"}).then((function(e){try{t.displayResults(JSON.parse(e.body))}catch(e){console.log(e),t.displayResults()}})).catch((function(){t.displayResults()}))}else this.displayResults()}},{key:"displayResults",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=document.getElementById("explore_results"),n=document.getElementById("explore_links");if(!e||!e.results)return t.style.display="none",void(n.style.display="block");for(var r=document.getElementById("explore_results_list");r.firstChild;)r.removeChild(r.firstChild);var i=e.results,l=e.total,a=e.terms;if(i.length>0){n.style.display="block",document.getElementById("explore_results_empty").style.display="none";var s,u=0,c=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,l=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw l}}}}(i);try{for(c.s();!(s=c.n()).done;){var d=s.value,p=d.type;d.game&&(p="".concat(d.game.name," ").concat(p)),d.mod&&d.mod.name&&(p="".concat(p," from ").concat(d.mod.name));var y=document.createElement("a");y.href=d.url;var f=document.createElement("span");f.className="result_type",f.appendChild(document.createTextNode(p)),y.appendChild(document.createTextNode(d.title)),y.appendChild(document.createElement("br")),y.appendChild(f);var m=document.createElement("li");m.className=u%2==0?"result even":"result odd",u++,m.appendChild(y),r.appendChild(m)}}catch(e){c.e(e)}finally{c.f()}}else n.style.display="none",document.getElementById("explore_results_empty").style.display="block";l>i.length?(document.getElementById("explore_results_right_button").style.display="block",this.searchMoreURL="/search/?query="+encodeURIComponent(a)):document.getElementById("explore_results_right_button").style.display="none",t.style.display="block",n.style.display="none"}}],null&&i(t.prototype,null),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();l(s,"container",null),l(s,"popover",null),l(s,"field",null),l(s,"link",null),l(s,"searchMoreURL",""),document.addEventListener("DOMContentLoaded",(function(){s.init(),document.querySelectorAll(".scriptonly").forEach((function(e){e.classList.remove("scriptonly")})),document.querySelectorAll(".noscript").forEach((function(e){e.classList.add("loaded")}))}))})();